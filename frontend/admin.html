<!DOCTYPE html>
<html>
<head>
  <title>Admin Dashboard</title>
  <style>
    body { font-family: Arial; padding: 40px; background:#0b0b0b; color:white; }
    h1 { color: #d4af37; }
    table { border-collapse: collapse; width: 100%; margin-top: 20px; }
    td, th { border: 1px solid #444; padding: 10px; }
  </style>
</head>
<body>

<h1>üìä Phoenix Admin Dashboard</h1>
<p>Total Signups: <b id="count">Loading...</b></p>

<table>
  <thead>
    <tr><th>Email</th><th>Time</th></tr>
  </thead>
  <tbody id="list"></tbody>
</table>

<script>
const SECRET = "supersecret123";
const API = "https://distress-backend-sj8y.onrender.com";

fetch(`${API}/admin/stats?key=${SECRET}`)
  .then(res => {
    if (!res.ok) throw new Error("Unauthorized");
    return res.json();
  })
  .then(data => {
    document.getElementById("count").innerText = data.total;
    const tbody = document.getElementById("list");

    data.contacts.forEach(c => {
      const tr = document.createElement("tr");
      tr.innerHTML = `<td>${c.email}</td><td>${new Date(c.time).toLocaleString()}</td>`;
      tbody.appendChild(tr);
    });
  })
  .catch(() => {
    document.body.innerHTML = "<h2>‚ùå Access Denied</h2>";
  });
</script>

</body>
</html>
